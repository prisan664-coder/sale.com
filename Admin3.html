<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <title>Admin - Visitor Logs</title>
    <link rel="shortcut icon"
        href="https://scontent.fvte1-1.fna.fbcdn.net/v/t39.30808-6/518825433_122117695760900284_354744809560286503_n.jpg?_nc_cat=102&ccb=1-7&_nc_sid=6ee11a&_nc_ohc=ldLnZ0tvy08Q7kNvwF7Ekl4&_nc_oc=AdlK_DvJpcucNDU2Pdijw4813aGABLoY7ukxzNCEhUUr9pakpwxVacXzJ08x8kQOfjg&_nc_zt=23&_nc_ht=scontent.fvte1-1.fna&_nc_gid=KGJcV5nwnpkb1syQENv5mQ&oh=00_AfjzcdNWomaPDeeWsmN0eF0-HLhLzbRNM8xBxCv2OuroFQ&oe=692D81D6"
        type="image/x-icon">
    <link rel="icon"
        href="https://scontent.fvte1-1.fna.fbcdn.net/v/t39.30808-6/518825433_122117695760900284_354744809560286503_n.jpg?_nc_cat=102&ccb=1-7&_nc_sid=6ee11a&_nc_ohc=ldLnZ0tvy08Q7kNvwF7Ekl4&_nc_oc=AdlK_DvJpcucNDU2Pdijw4813aGABLoY7ukxzNCEhUUr9pakpwxVacXzJ08x8kQOfjg&_nc_zt=23&_nc_ht=scontent.fvte1-1.fna&_nc_gid=KGJcV5nwnpkb1syQENv5mQ&oh=00_AfjzcdNWomaPDeeWsmN0eF0-HLhLzbRNM8xBxCv2OuroFQ&oe=692D81D6"
        type="image/x-icon">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            font-family: Arial;
            background: #f3f3f3;
            padding: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: #fff;
        }

        th,
        td {
            padding: 10px;
            border: 1px solid #ccc;
            font-size: 14px;
        }

        th {
            background: #222;
            color: #fff;
        }

        h2 {
            margin-bottom: 10px;
        }

        .count {
            font-size: 18px;
            margin-bottom: 20px;
            color: #0066cc;
        }
    </style>
</head>

<body>

    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm mb-4">
        <div class="container">
            <a class="navbar-brand text-primary fw-bold" href="Admin2.html">‚öôÔ∏è Admin Dashboard (Orders)</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html">Home (Customer View)</a></li>
                    <li class="nav-item"><a class="nav-link" href="admin-dashboard.html">Back to Admin</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <h2>üìä Visitor Logs (Firebase)</h2>
    <div class="count" id="visitorCount">Loading...</div>

    <table>
        <thead>
            <tr>
                <th>‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤</th>
                <th>IP</th>
                <th>‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</th>
                <th>URL</th>
            </tr>
        </thead>
        <tbody id="visitorTable"></tbody>
    </table>

    <script type="module">
        // ================= Firebase Import =================
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
        import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

        // ================= Firebase Config =================
        const firebaseConfig = {
            apiKey: "AIzaSyCLXIs8EaJNauHJpcnDMKU99C-uBKKR0aU",
            authDomain: "my-bank-87108.firebaseapp.com",
            databaseURL: "https://my-bank-87108-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "my-bank-87108",
            storageBucket: "my-bank-87108.firebasestorage.app",
            messagingSenderId: "692654082797",
            appId: "1:692654082797:web:3b5f9912900a8cb5409ae4",
            measurementId: "G-DHD6EWJW3X"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        const visitorCount = document.getElementById("visitorCount");
        const visitorTable = document.getElementById("visitorTable");

        // ================= Load Visitor Data =================
        const visitorRef = ref(db, "visitorLogs");

        onValue(visitorRef, (snapshot) => {
            visitorTable.innerHTML = "";

            let count = 0;

            snapshot.forEach((child) => {
                const data = child.val();
                count++;

                const row = document.createElement("tr");
                row.innerHTML = `
                <td>${data.time}</td>
                <td>${data.ip}</td>
                <td>${data.device}</td>
                <td>${data.url}</td>
            `;
                visitorTable.prepend(row);
            });

            visitorCount.innerHTML = `üë• ‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ä‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: ${count} ‡∏Ñ‡∏ô`;
        });
    </script>

</body>

</html>